{
  "swagger": "2.0",
  "info": {
    "description": "REST API für den KBOB Fachdatenkatalog. Lesender Zugriff ist öffentlich, Schreiboperationen erfordern Authentifizierung.",
    "title": "KBOB Fachdatenkatalog API",
    "version": "1.0.0"
  },
  "host": "sdomjwahhqrlyqyfyyeo.supabase.co",
  "basePath": "/rest/v1",
  "schemes": ["https"],
  "consumes": ["application/json", "text/csv"],
  "produces": ["application/json", "text/csv"],
  "securityDefinitions": {
    "apiKey": {
      "type": "apiKey",
      "name": "apikey",
      "in": "header",
      "description": "Supabase anon key für öffentlichen Lesezugriff"
    },
    "bearerAuth": {
      "type": "apiKey",
      "name": "Authorization",
      "in": "header",
      "description": "Bearer token für Schreiboperationen (service_role key)"
    }
  },
  "paths": {
    "/elements": {
      "get": {
        "summary": "Alle Elemente abrufen",
        "description": "Gibt eine Liste aller BIM-Elemente zurück",
        "security": [],
        "parameters": [
          {"$ref": "#/parameters/select"},
          {"$ref": "#/parameters/order"},
          {"$ref": "#/parameters/limit"},
          {"$ref": "#/parameters/offset"}
        ],
        "responses": {
          "200": {
            "description": "Erfolgreiche Abfrage",
            "schema": {"type": "array", "items": {"$ref": "#/definitions/elements"}}
          }
        },
        "tags": ["elements"]
      },
      "post": {
        "summary": "Element erstellen",
        "description": "Erstellt ein neues Element (erfordert Authentifizierung)",
        "security": [{"bearerAuth": []}],
        "parameters": [{"$ref": "#/parameters/body.elements"}],
        "responses": {"201": {"description": "Erstellt"}},
        "tags": ["elements"]
      },
      "patch": {
        "summary": "Element aktualisieren",
        "description": "Aktualisiert ein bestehendes Element (erfordert Authentifizierung)",
        "security": [{"bearerAuth": []}],
        "parameters": [
          {"$ref": "#/parameters/rowFilter.elements.id"},
          {"$ref": "#/parameters/body.elements"}
        ],
        "responses": {"204": {"description": "Aktualisiert"}},
        "tags": ["elements"]
      },
      "delete": {
        "summary": "Element löschen",
        "description": "Löscht ein Element (erfordert Authentifizierung)",
        "security": [{"bearerAuth": []}],
        "parameters": [{"$ref": "#/parameters/rowFilter.elements.id"}],
        "responses": {"204": {"description": "Gelöscht"}},
        "tags": ["elements"]
      }
    },
    "/documents": {
      "get": {
        "summary": "Alle Dokumente abrufen",
        "description": "Gibt eine Liste aller Dokumente zurück",
        "security": [],
        "parameters": [
          {"$ref": "#/parameters/select"},
          {"$ref": "#/parameters/order"},
          {"$ref": "#/parameters/limit"},
          {"$ref": "#/parameters/offset"}
        ],
        "responses": {
          "200": {
            "description": "Erfolgreiche Abfrage",
            "schema": {"type": "array", "items": {"$ref": "#/definitions/documents"}}
          }
        },
        "tags": ["documents"]
      },
      "post": {
        "summary": "Dokument erstellen",
        "security": [{"bearerAuth": []}],
        "parameters": [{"$ref": "#/parameters/body.documents"}],
        "responses": {"201": {"description": "Erstellt"}},
        "tags": ["documents"]
      },
      "patch": {
        "summary": "Dokument aktualisieren",
        "security": [{"bearerAuth": []}],
        "parameters": [
          {"$ref": "#/parameters/rowFilter.documents.id"},
          {"$ref": "#/parameters/body.documents"}
        ],
        "responses": {"204": {"description": "Aktualisiert"}},
        "tags": ["documents"]
      },
      "delete": {
        "summary": "Dokument löschen",
        "security": [{"bearerAuth": []}],
        "parameters": [{"$ref": "#/parameters/rowFilter.documents.id"}],
        "responses": {"204": {"description": "Gelöscht"}},
        "tags": ["documents"]
      }
    },
    "/usecases": {
      "get": {
        "summary": "Alle Anwendungsfälle abrufen",
        "description": "Gibt eine Liste aller BIM-Anwendungsfälle zurück",
        "security": [],
        "parameters": [
          {"$ref": "#/parameters/select"},
          {"$ref": "#/parameters/order"},
          {"$ref": "#/parameters/limit"},
          {"$ref": "#/parameters/offset"}
        ],
        "responses": {
          "200": {
            "description": "Erfolgreiche Abfrage",
            "schema": {"type": "array", "items": {"$ref": "#/definitions/usecases"}}
          }
        },
        "tags": ["usecases"]
      },
      "post": {
        "summary": "Anwendungsfall erstellen",
        "security": [{"bearerAuth": []}],
        "parameters": [{"$ref": "#/parameters/body.usecases"}],
        "responses": {"201": {"description": "Erstellt"}},
        "tags": ["usecases"]
      },
      "patch": {
        "summary": "Anwendungsfall aktualisieren",
        "security": [{"bearerAuth": []}],
        "parameters": [
          {"$ref": "#/parameters/rowFilter.usecases.id"},
          {"$ref": "#/parameters/body.usecases"}
        ],
        "responses": {"204": {"description": "Aktualisiert"}},
        "tags": ["usecases"]
      },
      "delete": {
        "summary": "Anwendungsfall löschen",
        "security": [{"bearerAuth": []}],
        "parameters": [{"$ref": "#/parameters/rowFilter.usecases.id"}],
        "responses": {"204": {"description": "Gelöscht"}},
        "tags": ["usecases"]
      }
    },
    "/models": {
      "get": {
        "summary": "Alle Fachmodelle abrufen",
        "description": "Gibt eine Liste aller BIM-Fachmodelle zurück",
        "security": [],
        "parameters": [
          {"$ref": "#/parameters/select"},
          {"$ref": "#/parameters/order"},
          {"$ref": "#/parameters/limit"},
          {"$ref": "#/parameters/offset"}
        ],
        "responses": {
          "200": {
            "description": "Erfolgreiche Abfrage",
            "schema": {"type": "array", "items": {"$ref": "#/definitions/models"}}
          }
        },
        "tags": ["models"]
      },
      "post": {
        "summary": "Fachmodell erstellen",
        "security": [{"bearerAuth": []}],
        "parameters": [{"$ref": "#/parameters/body.models"}],
        "responses": {"201": {"description": "Erstellt"}},
        "tags": ["models"]
      },
      "patch": {
        "summary": "Fachmodell aktualisieren",
        "security": [{"bearerAuth": []}],
        "parameters": [
          {"$ref": "#/parameters/rowFilter.models.id"},
          {"$ref": "#/parameters/body.models"}
        ],
        "responses": {"204": {"description": "Aktualisiert"}},
        "tags": ["models"]
      },
      "delete": {
        "summary": "Fachmodell löschen",
        "security": [{"bearerAuth": []}],
        "parameters": [{"$ref": "#/parameters/rowFilter.models.id"}],
        "responses": {"204": {"description": "Gelöscht"}},
        "tags": ["models"]
      }
    },
    "/epds": {
      "get": {
        "summary": "Alle Ökobilanzdaten abrufen",
        "description": "Gibt eine Liste aller KBOB Ökobilanzdaten (EPDs) zurück",
        "security": [],
        "parameters": [
          {"$ref": "#/parameters/select"},
          {"$ref": "#/parameters/order"},
          {"$ref": "#/parameters/limit"},
          {"$ref": "#/parameters/offset"}
        ],
        "responses": {
          "200": {
            "description": "Erfolgreiche Abfrage",
            "schema": {"type": "array", "items": {"$ref": "#/definitions/epds"}}
          }
        },
        "tags": ["epds"]
      },
      "post": {
        "summary": "Ökobilanzdaten erstellen",
        "security": [{"bearerAuth": []}],
        "parameters": [{"$ref": "#/parameters/body.epds"}],
        "responses": {"201": {"description": "Erstellt"}},
        "tags": ["epds"]
      },
      "patch": {
        "summary": "Ökobilanzdaten aktualisieren",
        "security": [{"bearerAuth": []}],
        "parameters": [
          {"$ref": "#/parameters/rowFilter.epds.id"},
          {"$ref": "#/parameters/body.epds"}
        ],
        "responses": {"204": {"description": "Aktualisiert"}},
        "tags": ["epds"]
      },
      "delete": {
        "summary": "Ökobilanzdaten löschen",
        "security": [{"bearerAuth": []}],
        "parameters": [{"$ref": "#/parameters/rowFilter.epds.id"}],
        "responses": {"204": {"description": "Gelöscht"}},
        "tags": ["epds"]
      }
    }
  },
  "definitions": {
    "elements": {
      "type": "object",
      "properties": {
        "id": {"type": "string", "description": "Eindeutige Element-ID"},
        "version": {"type": "string"},
        "last_change": {"type": "string", "format": "date"},
        "title": {"type": "string"},
        "image": {"type": "string"},
        "category": {"type": "string"},
        "description": {"type": "string"},
        "tags": {"type": "array", "items": {"type": "string"}},
        "classifications": {"type": "object"},
        "ifc_mapping": {"type": "array"},
        "geometry": {"type": "array"},
        "information": {"type": "array"},
        "created_at": {"type": "string", "format": "date-time"}
      }
    },
    "documents": {
      "type": "object",
      "properties": {
        "id": {"type": "string", "description": "Eindeutige Dokument-ID"},
        "version": {"type": "string"},
        "last_change": {"type": "string", "format": "date"},
        "title": {"type": "string"},
        "image": {"type": "string"},
        "category": {"type": "string"},
        "description": {"type": "string"},
        "tags": {"type": "array", "items": {"type": "string"}},
        "formats": {"type": "array", "items": {"type": "string"}},
        "retention": {"type": "string"},
        "phases": {"type": "array", "items": {"type": "integer"}},
        "classifications": {"type": "object"},
        "created_at": {"type": "string", "format": "date-time"}
      }
    },
    "usecases": {
      "type": "object",
      "properties": {
        "id": {"type": "string", "description": "Eindeutige Anwendungsfall-ID"},
        "version": {"type": "string"},
        "last_change": {"type": "string", "format": "date"},
        "title": {"type": "string"},
        "image": {"type": "string"},
        "category": {"type": "string"},
        "description": {"type": "string"},
        "tags": {"type": "array", "items": {"type": "string"}},
        "phases": {"type": "array", "items": {"type": "integer"}},
        "standards": {"type": "array", "items": {"type": "string"}},
        "goals": {"type": "array", "items": {"type": "string"}},
        "roles": {"type": "array"},
        "created_at": {"type": "string", "format": "date-time"}
      }
    },
    "models": {
      "type": "object",
      "properties": {
        "id": {"type": "string", "description": "Eindeutige Fachmodell-ID"},
        "version": {"type": "string"},
        "last_change": {"type": "string", "format": "date"},
        "title": {"type": "string"},
        "image": {"type": "string"},
        "category": {"type": "string"},
        "description": {"type": "string"},
        "tags": {"type": "array", "items": {"type": "string"}},
        "phases": {"type": "array", "items": {"type": "integer"}},
        "elements": {"type": "array"},
        "created_at": {"type": "string", "format": "date-time"}
      }
    },
    "epds": {
      "type": "object",
      "properties": {
        "id": {"type": "string", "description": "KBOB EPD ID"},
        "title": {"type": "string"},
        "category": {"type": "string"},
        "subcategory": {"type": "string"},
        "description": {"type": "string"},
        "tags": {"type": "array", "items": {"type": "string"}},
        "uuid": {"type": "string"},
        "unit": {"type": "string"},
        "gwp": {"type": "number", "description": "Global Warming Potential (kg CO2-eq)"},
        "ubp": {"type": "number", "description": "Umweltbelastungspunkte"},
        "penrt": {"type": "number", "description": "Primärenergie nicht erneuerbar (MJ)"},
        "pert": {"type": "number", "description": "Primärenergie erneuerbar (MJ)"},
        "density": {"type": "string"},
        "created_at": {"type": "string", "format": "date-time"}
      }
    }
  },
  "parameters": {
    "select": {
      "name": "select",
      "description": "Spalten auswählen (z.B. id,title,description)",
      "required": false,
      "in": "query",
      "type": "string"
    },
    "order": {
      "name": "order",
      "description": "Sortierung (z.B. title.asc, created_at.desc)",
      "required": false,
      "in": "query",
      "type": "string"
    },
    "limit": {
      "name": "limit",
      "description": "Maximale Anzahl Ergebnisse",
      "required": false,
      "in": "query",
      "type": "integer"
    },
    "offset": {
      "name": "offset",
      "description": "Anzahl zu überspringender Ergebnisse",
      "required": false,
      "in": "query",
      "type": "integer"
    },
    "body.elements": {
      "name": "elements",
      "required": true,
      "in": "body",
      "schema": {"$ref": "#/definitions/elements"}
    },
    "body.documents": {
      "name": "documents",
      "required": true,
      "in": "body",
      "schema": {"$ref": "#/definitions/documents"}
    },
    "body.usecases": {
      "name": "usecases",
      "required": true,
      "in": "body",
      "schema": {"$ref": "#/definitions/usecases"}
    },
    "body.models": {
      "name": "models",
      "required": true,
      "in": "body",
      "schema": {"$ref": "#/definitions/models"}
    },
    "body.epds": {
      "name": "epds",
      "required": true,
      "in": "body",
      "schema": {"$ref": "#/definitions/epds"}
    },
    "rowFilter.elements.id": {
      "name": "id",
      "description": "Filter nach Element-ID (eq.e1)",
      "required": false,
      "in": "query",
      "type": "string"
    },
    "rowFilter.documents.id": {
      "name": "id",
      "description": "Filter nach Dokument-ID",
      "required": false,
      "in": "query",
      "type": "string"
    },
    "rowFilter.usecases.id": {
      "name": "id",
      "description": "Filter nach Anwendungsfall-ID",
      "required": false,
      "in": "query",
      "type": "string"
    },
    "rowFilter.models.id": {
      "name": "id",
      "description": "Filter nach Fachmodell-ID",
      "required": false,
      "in": "query",
      "type": "string"
    },
    "rowFilter.epds.id": {
      "name": "id",
      "description": "Filter nach EPD-ID",
      "required": false,
      "in": "query",
      "type": "string"
    }
  },
  "externalDocs": {
    "description": "PostgREST API Dokumentation",
    "url": "https://postgrest.org/en/v14/references/api.html"
  }
}
